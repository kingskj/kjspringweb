# GPT Context (kjspringweb)

이 파일은 이 저장소 대화의 **단일 맥락 기준 파일**이다.
새 세션은 이 파일을 먼저 읽고 시작한다.

## 1) 프로젝트 성격
- 프로젝트: `kjspringweb`
- 목적: 서비스 안정성보다 **의도적 에러 유도/관측/검증** 중심 테스트 시스템
- 운영 전제: GCP 배포 환경 + 로컬 동시 운용
- 리소스 가정: 2코어 / 1GB 메모리 / 2GB 스왑
- DB: H2 유지(교체 계획 없음)

## 2) 작업 사상 (중요)
- 화면(클라이언트) 검증보다 서버/DB 제약으로 실패를 유도한다.
- 에러를 숨기지 않고 관측 가능하게 만든다(팝업/로그/실패 상태).
- 기본 데이터 시드는 "없을 때만" 수행하여 실제 DB처럼 유지한다.
- 테스트 시나리오를 위해 일반 서비스 관점의 보안/UX 최적화를 일부 의도적으로 완화한다.

## 3) 이 대화방에서 확정된 핵심 변경 요약
1. 벨리데이션/에러 처리
- 소스단/화면 필수값 검증 다수 제거
- 500 페이지 중심 처리 대신, REST 전환 흐름에서 팝업/현 화면 유지 중심으로 조정

2. REST 전환
- 액티브 요청을 REST 중심으로 전환
- 화면에서는 기존 UX처럼 보이도록 리다이렉트/후처리

3. 데이터/스키마
- 게시판 제목 `NOT NULL`, 길이 100 반영
- 메뉴 테이블 제약 강화: 메뉴명/URL/순서/상태 `NOT NULL`, URL `UNIQUE`
- 기본 데이터는 재생성 남발하지 않도록 정리

4. 회원/권한
- 회원관리 항목 확장(비밀번호 표시 등)
- 회원정보 수정/탈퇴 기능 추가
- 테스트 목적상 원본 비밀번호 컬럼 저장 및 관리자 노출 반영

5. 게시판 정책
- 게시판 유형 컬럼 도입: `공지사항 / 인사 / 일반`
- 관리자: 전체 수정/삭제 가능
- 일반 사용자: 본인 글만 수정/삭제 가능, 유형은 보이되 수정 불가(일반 고정)

6. 배치
- Spring Batch 구성 완료
- 인사 배치: Tasklet -> Service insert 방식
- 삭제 배치: Step 방식
- 짝수일 강제 에러 로직 포함

7. 스케줄 (현재값)
- 인사 배치 2개: 매일 19:20
- 삭제 배치: 매일 19:22

8. 트랜잭션 결론
- Step 간 트랜잭션은 분리됨(앞 step 커밋 후 다음 step 실패 시 롤백 안 됨)
- 현재는 삭제 + 강제에러를 동일 step/동일 트랜잭션에 묶어, 짝수일 실패 시 삭제 롤백되도록 수정됨
- 2026-02-28 검증에서 롤백 동작 확인 완료

## 4) 참고 문서
- 상세 일지: `docs/h202602281926.md`

## 5) 유지 규칙
1. 작업 중 정책/구조/운영값이 바뀌면 이 파일을 우선 갱신한다.
2. 일지는 이력 기록용이고, 현재 맥락의 최종 기준은 항상 `gpt.md`다.
3. 사용자 최신 지시가 충돌하면 최신 지시를 우선한다.
